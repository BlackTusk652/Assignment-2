\documentclass[12pt,legal]{article}
\usepackage{theorem,ifthen,algorithm,algorithmic}
\usepackage{amssymb,amsfonts,amsmath,latexsym,dsfont}
\usepackage{tikz,pgflibraryplotmarks}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{mathrsfs}


\graphicspath{{images/}{./}}

\usepackage{boxedminipage}

\usepackage{pgf,pgfarrows} %% pdf-drawing package
\usepackage{subfigure} %% pdf-drawing package
\newcommand{\cell}{\mathrm{cell}}
\newcommand{\DIV}{\ensuremath{\mathop{\mathbf{DIV}}}}
\newcommand{\GRAD}{\ensuremath{\mathop{\mathbf{GRAD}}}}
\newcommand{\CURL}{\ensuremath{\mathop{\mathbf{CURL}}}}
\newcommand{\CURLt}{\ensuremath{\mathop{\overline{\mathbf{CURL}}}}}
\newcommand{\nullspace}{\ensuremath{\mathop{\mathrm{null}}}}

\newcommand{\FrameboxA}[2][]{#2}
\newcommand{\Framebox}[1][]{\FrameboxA}
\newcommand{\Fbox}[1]{#1}

%\usepackage[round]{natbib}

\newcommand{\half}{\mbox{\small \(\frac{1}{2}\)}}
\newcommand{\hf}{{\frac 12}}
\newcommand {\HH}  { {\bf H} }
\newcommand{\hH}{\widehat{H}}
\newcommand{\hL}{\widehat{L}}
\newcommand{\bmath}[1]{\mbox{\bf #1}}
\newcommand{\hhat}[1]{\stackrel{\scriptstyle \wedge}{#1}}
%\newcommand{\R}{{\rm I\!R}}
\newcommand {\D} {{\nabla2}}
\newcommand {\sg}{{\hsigma}}

\newcommand {\wsg}{{\widehat \sigma}}
\newcommand {\wmu}{{\widehat \mu}}


\newcommand{\wE}{\widehat {\vec E}}
\newcommand{\wH}{\widehat {\vec H}}
\newcommand{\wJ}{\widehat {\vec J}}
\newcommand{\ws}{\widehat {\vec s}}

\newcommand{\E}{\vec{E}}
\newcommand{\B}{\vec{B}}

\renewcommand{\H}{\vec{H}}
\newcommand{\J}{\vec{J}}
\newcommand{\dd}{d^{\rm obs}}
\newcommand{\F}{\vec{F}}
\newcommand{\C}{\vec{C}}
\newcommand{\s}{\vec{s}}
\newcommand{\N}{\vec{N}}
\newcommand{\M}{\vec{M}}
\newcommand{\A}{\vec{A}}
\newcommand{\w}{\vec{w}}
\newcommand{\nn}{\vec{n}}
\newcommand{\cA}{{\cal A}}
\newcommand{\cQ}{{\cal Q}}
\newcommand{\cR}{{\cal R}}
\newcommand{\cG}{{\cal G}}
\newcommand{\cW}{{\cal W}}
\newcommand{\hsig}{\hat \sigma}
\newcommand{\hJ}{\hat \J}
\newcommand{\hbeta}{\widehat \beta}
\newcommand{\lam}{\lambda}
\newcommand{\dt}{\delta t}
\newcommand{\kp}{\kappa}
\newcommand {\lag} { {\cal L}}
\newcommand{\zero}{\vec{0}}
\newcommand{\Hr}{H_{red}}
\newcommand{\Mr}{M_{red}}
\newcommand{\mr}{m_{ref}}
\newcommand{\thet}{\ensuremath{\mbox{\boldmath $\theta$}}}
\newcommand{\curl}{\ensuremath{\nabla\times\,}}
\newcommand{\curlc}{\ensuremath{\nabla_{{\boldsymbol \xi}}\times\,}}
\renewcommand{\div}{\nabla\cdot\,}
\newcommand{\grad}{\ensuremath{\nabla}}
\newcommand{\dm}{\delta m}
\newcommand{\gradh}{\ensuremath{\nabla}_h}
\newcommand{\divh}{\nabla_h\cdot\,}
\newcommand{\curlh}{\ensuremath{\nabla_h\times\,}}
\newcommand{\curlht}{\ensuremath{\nabla_h^T\times\,}}
\newcommand{\Q}{\vec{Q}}
\newcommand{\V}{\vec{V}}
\newcommand{\W}{\vec{W}}

\newcommand{\bfA}{{\bf A}}
\newcommand{\bfB}{{\bf B}}
\newcommand{\bfC}{{\bf C}}
\newcommand{\bfD}{{\bf D}}
\newcommand{\bfE}{{\bf E}}
\newcommand{\bfF}{{\bf F}}
\newcommand{\bfG}{{\bf G}}
\newcommand{\bfH}{{\bf H}}
\newcommand{\bfI}{{\bf I}}
\newcommand{\bfJ}{{\bf J}}
\newcommand{\bfK}{{\bf K}}
\newcommand{\bfL}{{\bf L}}
\newcommand{\bfM}{{\bf M}}
\newcommand{\bfN}{{\bf N}}
\newcommand{\bfO}{{\bf O}}
\newcommand{\bfP}{{\bf P}}
\newcommand{\bfQ}{{\bf Q}}
\newcommand{\bfR}{{\bf R}}
\newcommand{\bfS}{{\bf S}}
\newcommand{\bfT}{{\bf T}}
\newcommand{\bfU}{{\bf U}}
\newcommand{\bfV}{{\bf V}}
\newcommand{\bfW}{{\bf W}}
\newcommand{\bfX}{{\bf X}}
\newcommand{\bfY}{{\bf Y}}
\newcommand{\bfZ}{{\bf Z}}

\newcommand{\bfa}{{\bf a}}
\newcommand{\bfb}{{\bf b}}
\newcommand{\bfe}{{\bf e}}
\newcommand{\bfh}{{\bf h}}
\newcommand{\bfj}{{\bf j}}
\newcommand{\bfi}{{\bf i}}
\newcommand{\bfs}{{\bf s}}
\newcommand{\bfx}{{\bf x}}
\newcommand{\bfy}{\vec {\bf y}}
\newcommand{\bfu}{{\bf u}}
\newcommand{\bfq}{{\bf q}}
\newcommand{\bfp}{{\bf p}}
\newcommand{\bfn}{{\bf n}}
\newcommand{\bfd}{{\bf d}}
\newcommand{\bfm}{{\bf m}}
\newcommand{\bfr}{{\bf r}}
\newcommand{\bff}{{\bf f}}
\newcommand{\bfv}{{\bf v}}





\newcommand{\CL}{{\cal L}}
\newcommand{\CO}{{\cal O}}
\newcommand{\CP}{{\cal P}}
\newcommand{\CQ}{{\cal Q}}
\newcommand{\CH}{{\mathscr H}}

\newcommand{\Fc}{{\cal F}}
\newcommand{\bfphi}{{\boldsymbol \varphi}}
\newcommand{\bfpsi}{{\boldsymbol \psi}}
\newcommand{\bfepsilon}{{\boldsymbol \epsilon}}

\newcommand{\Ex}{{\rm E}}
\newcommand{\Var}{{\rm Var}}

%\newcommand{\diag}{\mathrm{diag}\,}
\newcommand{\diag}{{\sf{diag}}\,}

\newcommand{\wht}{\widehat}
%\renewcommand{\vec}[1]{\ensuremath{\mathbf{#1}}}
\newcommand{\rf}{\rm ref}

\newcommand{\kk}{\vec{k}}
\newcommand{\bo}{d^{\rm obs}}
%\newcommand{\xx}{\vec{x}}
\newcommand{\what}{\widehat}
\renewcommand{\theequation}{\arabic{section}.\arabic{equation}}

\newcommand{\trace}{\mathsf{trace}}
\newcommand{\st}{\mathrm{s.t.}}


\newcommand{\R}{\ensuremath{\mathds{R}}}
\newcommand{\abs}[1]{\ensuremath{\left|#1\right|}}
\newcommand{\norm}[1]{\ensuremath{\left\|#1\right\|}}
\newcommand{\iprod}[1]{\ensuremath{\left\langle#1\right\rangle}}

\newcommand{\dwu}{\delta \widehat u}
\newcommand{\dwx}{\delta \widehat x}
\newcommand{\Mu}{M_{\mu}}
\newcommand{\hv}{\hat v}

\newcommand{\curlxi}{{\widehat \nabla_{\bfxi} \times}}

\newcommand{\bfxi}{{ {\boldsymbol \xi}}}
\newcommand{\wq}{{\widehat q}}

\newcommand{\e}{{\cal E }}
\newcommand{\h}{{\cal H }}
\renewcommand{\j}{{\cal J }}
\renewcommand{\b}{{\cal B }}

\renewcommand{\w}{{\omega }}
\newcommand{\du}{{\delta u}}

\renewcommand{\t} {^{\top}}                                % transpose, e.g. $A\t$


\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem{proof}{Proof}
\newtheorem{example}{Example}

\begin{document}
\title{Homework Assignment 2}
\author{Eldad Haber\thanks{Department of Earth and Ocean Science, The University of British Columbia, Vancouver, BC, Canada}}

\maketitle

{\bf This will keep you off the street for a while so please start early!} 

\vspace{1cm}


Consider the so called advection diffusion  ODE
$$ {\frac {d}{dx}} \left( \sigma(x) {\frac {dp}{dx}}\right) + \mu {\frac {dp}{dx}} = q $$
with boundary conditions
$$p(0) = 0 \quad \quad p(1) = 0 $$

{\Large Part One - Pen and paper}
\begin{enumerate}
\item[1]
Use the flux $J = \sigma p_x$ and rewrite the
equation as a system of first order equations

\item[2]
Use the following discretization to solve the problem.
Put $p$ on the {\bf nodes} of your mesh and $J$ in {\bf cell centers.}

Write a discrete system of equations that approximate the continuous system to second order accuracy.
Use index notation.

\item[3]
Discuss your approximation of boundary conditions.

\item[4]
Write your system using matrix notation.

\item[5]
Eliminate $J$ from the equations to obtain a system on $p$

\end{enumerate}

{\Large Part two - Computer}
\begin{enumerate}
\item Code your discretization into a function \\
{\rm function[p] = convAdvec(h,sigma,mu,q)} \\
See further instructions in the starter code file \verb!convAdvec.m! on GitHub.

\item Use the following functions to test your code
\begin{itemize}
	\item $p = sin(2 \pi x)$, $\sigma = 1+x^2$, $\mu = 0.1$.
	\item $p = sin(2 \pi x)$, $\sigma = 1+x^2$, $\mu = 10$.
\end{itemize}
Use $h = 10^{-i}, i=2,\ldots 5$. Note that you will have to compute the corresponding source function q for each test function and write your own testing script. Discuss the results of your tests.

\end{enumerate}


\end{document}
